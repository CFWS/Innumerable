!function(t){function n(){}function i(t,e){return function(){t.apply(e,arguments)}}function u(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function c(t,e){for(;3===t._state;)t=t._value;return 0===t._state?void t._deferreds.push(e):(t._handled=!0,void o(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._state?a:l)(e.promise,t._value);var o;try{o=n(t._value)}catch(r){return void l(e.promise,r)}a(e.promise,o)}))}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof u)return t._state=3,t._value=e,void s(t);if("function"==typeof n)return void d(i(n,e),t)}t._state=1,t._value=e,s(t)}catch(o){l(t,o)}}function l(t,e){t._state=2,t._value=e,s(t)}function s(t){2===t._state&&0===t._deferreds.length&&o(function(){t._handled||r(t._value)});for(var e=0,n=t._deferreds.length;n>e;e++)c(t,t._deferreds[e]);t._deferreds=null}function f(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function d(t,e){var n=!1;try{t(function(t){n||(n=!0,a(e,t))},function(t){n||(n=!0,l(e,t))})}catch(o){if(n)return;n=!0,l(e,o)}}var e=setTimeout,o="function"==typeof setImmediate&&setImmediate||function(t){e(t,0)},r=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};u.prototype["catch"]=function(t){return this.then(null,t)},u.prototype.then=function(t,e){var o=new this.constructor(n);return c(this,new f(t,e,o)),o},u.all=function(t){var e=Array.prototype.slice.call(t);return new u(function(t,n){function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c)return void c.call(u,function(t){r(i,t)},n)}e[i]=u,0===--o&&t(e)}catch(a){n(a)}}if(0===e.length)return t([]);for(var o=e.length,i=0;i<e.length;i++)r(i,e[i])})},u.resolve=function(t){return t&&"object"==typeof t&&t.constructor===u?t:new u(function(e){e(t)})},u.reject=function(t){return new u(function(e,n){n(t)})},u.race=function(t){return new u(function(e,n){for(var o=0,r=t.length;r>o;o++)t[o].then(e,n)})},u._setImmediateFn=function(t){o=t},u._setUnhandledRejectionFn=function(t){r=t},"undefined"!=typeof module&&module.exports?module.exports=u:t.Promise||(t.Promise=u)}(this);